from argparse import ArgumentParser
import numpy as np
import xml.etree.ElementTree as ET
from PIL import Image 
from pathlib import Path
import cv2
from os.path import join
from tqdm import tqdm
from concurrent.futures import ProcessPoolExecutor

def main():
    parser = ArgumentParser()
    parser.add_argument('image_dir')
    parser.add_argument('annotation_dir')
    parser.add_argument('dst')
    parser.add_argument('--save-image', action='store_true')
    parser.add_argument('--xml-dir', default='/opt/conda/lib/python3.6/site-packages/cv2/data/')

    args = parser.parse_args()

    images = list(Path(args.image_dir).glob('*.jpg'))
    category_to_dir = {str(d.stem).split('-')[0] : d for d in Path(args.annotation_dir).glob('*') if d.is_dir()}
    Path(args.dst).mkdir(parents=True, exist_ok=True)

    detectors = [
        cv2.CascadeClassifier(join(args.xml_dir, 'haarcascade_frontalcatface_extended.xml')),
#        cv2.CascadeClassifier(join(args.xml_dir, 'haarcascade_frontalcatface.xml'))
    ]

    ret = []
    categories = []
    # blacklist = []

    for image in images:
        name = image.stem
        category, _ = name.split('_')
        xml_path = category_to_dir[category].joinpath(name)
        assert xml_path.is_file()
        tree = ET.parse(xml_path)
        root = tree.getroot()
        objects = root.findall('object')
        if len(objects) == 0:
            print(len(objects))
            continue
        
        img = Image.open(image)
        # s = min(img.width, img.height)
        # org = img.crop((0, 0, s, s))
        # org = org.resize((64,64), Image.ANTIALIAS)
        # if args.save_image:
        #     org.save(Path(args.dst).joinpath(image.name))
        # ret.append(np.asanyarray(org))
        
        for i, o in enumerate(objects):
            category_name = o.find('name').text
            bndbox = o.find('bndbox') 
            xmin = int(bndbox.find('xmin').text)
            ymin = int(bndbox.find('ymin').text)
            xmax = int(bndbox.find('xmax').text)
            ymax = int(bndbox.find('ymax').text)
            dx = xmax - xmin
            dy = ymax - ymin
            # if dx > dy and dy/dx < 0.6:
            #     continue
            w = np.min((dx, dy))
            cropped = img.crop((xmin, ymin, xmin+w, ymin+w))
            cropped = cropped.resize((64,64), Image.ANTIALIAS)
            out_filename = image.stem + '_{}'.format(i) + image.suffix
            # if Path(out_filename).stem in blacklist:
                # continue
            # cv2.imshow('img', np.asarray(cropped)[..., ::-1])
            # k = cv2.waitKey(0)
            # if k == ord(' '):
            #     f = Path(out_filename).stem
            #     print('adding to blacklist: {}'.format(f))
            #     blacklist.append(f)
            #     continue
            if args.save_image:
                cropped.save(Path(args.dst).joinpath(out_filename))

            if category_name in categories:
                label = categories.index(category_name)
            else:
                label = len(categories)
                categories.append(category_name)
            ret.append((np.asarray(cropped).transpose(2, 0, 1).astype(np.float32), np.array(label, np.int32)))

            # if dx > dy:
            #     cropped = img.crop((xmax-w, ymin, xmax, ymin+w))
            #     cropped = cropped.resize((64,64), Image.ANTIALIAS)
            #     out_filename = image.stem + '_{}_tr'.format(i) + image.suffix
            #     if args.save_image:
            #         cropped.save(Path(args.dst).joinpath(out_filename))
            #     ret.append((np.asarray(cropped).transpose(2, 0, 1).astype(np.float32), np.array(label, np.int32)))

    print(len(ret))
    with open(Path(args.dst).joinpath('blacklist.txt'), 'w') as f:
        f.write('\n '.join(blacklist))

    np.save(Path(args.dst).joinpath('data.npy'), ret, allow_pickle=True)

blacklist = [
    'n02088094_8631_0',
    'n02093991_877_1',
    'n02087046_4614_0',
    'n02104029_4800_0',
    'n02106166_416_0',
    'n02085782_919_0',
    'n02106550_1388_0',
    'n02102480_4380_0',
    'n02088632_3433_0',
    'n02105641_309_0',
    'n02088632_403_0',
    'n02093754_7440_0',
    'n02112018_1518_0',
    'n02089078_1366_0',
    'n02091635_335_0',
    'n02090721_3149_1',
    'n02092002_2981_0',
    'n02105162_6459_0',
    'n02097209_1_0',
    'n02091831_3643_0',
    'n02099601_1028_0',
    'n02094433_5155_0',
    'n02115641_12922_0',
    'n02089973_811_0',
    'n02107142_7731_0',
    'n02098413_2441_0',
    'n02111500_1603_0',
    'n02110185_8154_0',
    'n02096437_4300_0',
    'n02096051_7762_0',
    'n02096437_4466_0',
    'n02110627_2416_0',
    'n02116738_9282_0',
    'n02102040_3586_0',
    'n02111129_1447_0',
    'n02089078_2337_0',
    'n02105505_43_0',
    'n02096051_3538_0',
    'n02110958_12807_0',
    'n02099429_961_0',
    'n02107908_4669_0',
    'n02107908_4669_1',
    'n02099849_2935_0',
    'n02110806_479_0',
    'n02092002_11105_1',
    'n02096177_5117_0',
    'n02088466_7801_0',
    'n02106662_9226_0',
    'n02089867_3253_0',
    'n02110185_6409_0',
    'n02108089_1104_0',
    'n02091831_13361_0',
    'n02110958_15615_1',
    'n02087394_9352_0',
    'n02109961_4619_0',
    'n02100583_3383_0',
    'n02112018_6129_0',
    'n02097130_1699_0',
    'n02087394_11442_0',
    'n02112018_3737_0',
    'n02089078_944_0',
    'n02112137_6709_0',
    'n02110185_9855_0',
    'n02089078_3613_0',
    'n02111277_176_0',
    'n02105641_4577_0',
    'n02113978_3640_1',
    'n02104029_3570_0',
    'n02105505_317_0',
    'n02112350_6906_0',
    'n02097209_1963_0',
    'n02094433_2564_0',
    'n02089867_2039_0',
    'n02116738_5241_1',
    'n02116738_5241_3',
    'n02113712_2379_0',
    'n02116738_6748_1',
    'n02100877_6852_0',
    'n02104029_4223_0',
    'n02097474_2913_0',
    'n02096437_1668_1',
    'n02100877_4506_0',
    'n02090721_3773_0',
    'n02101006_1506_0',
    'n02102040_4821_0',
    'n02091032_372_0',
    'n02108551_8943_0',
    'n02093428_6949_1',
    'n02096585_6855_0',
    'n02085782_845_0',
    'n02107683_1421_0',
    'n02093647_1870_0',
    'n02110627_2748_0',
    'n02093428_19652_0',
    'n02097209_3423_0',
    'n02090721_1819_0',
    'n02093859_2098_0',
    'n02091134_16201_0',
    'n02099849_4767_0',
    'n02105056_4787_0',
    'n02087394_1336_0',
    'n02104029_3766_0',
    'n02111129_1094_0',
    'n02097474_8796_0',
    'n02094258_871_1',
    'n02112350_7826_0',
    'n02099849_3753_0',
    'n02091032_3213_0',
    'n02102177_4202_0',
    'n02115913_1352_0',
    'n02105251_8540_0',
    'n02096294_8706_0',
    'n02086079_6333_0',
    'n02099712_6646_0',
    'n02095889_3047_0',
    'n02116738_806_0',
    'n02116738_806_1',
    'n02099267_443_0',
    'n02091467_3135_0',
    'n02098105_3359_0',
    'n02108089_2791_0',
    'n02085936_7253_0',
    'n02100236_4490_0',
    'n02095570_434_0',
    'n02095570_434_1',
    'n02086240_1843_1',
    'n02091831_5384_0',
    'n02110627_9634_0',
    'n02093647_2388_0',
    'n02111129_1042_0',
    'n02101006_489_0',
    'n02100735_7078_0',
    'n02108551_12438_0',
    'n02099601_7706_0',
    'n02115641_8798_0',
    'n02111500_6227_0',
    'n02099849_1408_0',
    'n02115913_1622_0',
    'n02096177_1589_0',
    'n02087394_1874_0',
    'n02099849_3592_0',
    'n02091032_4971_0',
    'n02096437_956_0',
    'n02105855_15724_0',
    'n02113978_3655_0',
    'n02090721_327_0',
    'n02113023_11397_0',
    'n02100583_14263_0',
    'n02095314_1282_0',
    'n02089973_3647_0',
    'n02102177_1187_0',
    'n02096051_3317_0',
    'n02102040_5096_0',
    'n02110063_13126_0',
    'n02116738_4758_0',
    'n02116738_4758_1',
    'n02095570_4511_0',
    'n02116738_2329_0',
    'n02116738_219_0',
    'n02100583_702_0',
    'n02104365_3950_0',
    'n02090721_2083_0',
    'n02115913_1742_0',
    'n02111889_16116_0',
    'n02110958_16453_0',
    'n02110958_16453_1',
    'n02090721_6232_0',
    'n02109525_11465_1',
    'n02113023_5295_0',
    'n02111889_4484_0',
    'n02115913_3800_0',
    'n02110063_15580_0',
    'n02088364_12745_0',
    'n02100877_4895_0',
    'n02115641_1145_1',
    'n02115913_3196_1',
    'n02094258_247_1',
    'n02086646_3484_0',
    'n02102480_6569_0',
    'n02088364_14863_0',
    'n02099267_1142_0',
    'n02096294_7541_1',
    'n02110806_849_0',
    'n02110806_849_2',
    'n02093991_686_0',
    'n02099712_2226_0',
    'n02089078_2108_0',
    'n02100583_10367_0',
    'n02099429_1662_0',
    'n02088364_16721_0',
    'n02091467_3727_0',
    'n02096437_3888_1',
    'n02092339_6498_0',
    'n02111277_3067_0',
    'n02107142_385_0',
    'n02088238_10005_0',
    'n02093647_356_0',
    'n02094258_2583_0',
    'n02088238_10013_0',
    'n02091831_4846_0',
    'n02090721_2254_0',
    'n02100877_7636_0',
    'n02086646_1246_0',
    'n02111129_4716_0',
    'n02111129_4716_1',
    'n02099849_3619_0',
    'n02115913_1224_0',
    'n02109961_2727_0',
    'n02098413_9259_0',
    'n02091032_1228_0',
    'n02107574_1390_0',
    'n02098413_4033_0',
    'n02091134_17054_1',
    'n02087394_6506_0',
    'n02113712_3312_0',
    'n02089973_1132_3',
    'n02101006_266_0',
    'n02092002_1086_1',
    'n02088094_482_0',
    'n02097047_5308_0',
    'n02091831_9190_0',
    'n02088466_9191_0',
    'n02108000_1832_2',
    'n02108000_1832_3',
    'n02111129_2617_0',
    'n02107312_6680_0',
    'n02086240_11692_0',
    'n02092002_3861_0',
    'n02111129_861_0',
    'n02102480_6027_1',
    'n02105505_3887_0',
    'n02104365_1837_0',
    'n02088632_819_0',
    'n02108089_1675_0',
    'n02099849_4348_0',
    'n02099849_4348_1',
    'n02090379_4388_0',
    'n02098413_8379_1',
    'n02113186_2499_0',
    'n02088094_5855_0',
    'n02088094_5855_1',
    'n02105641_2918_0',
    'n02091467_4472_0',
    'n02107574_2276_0',
    'n02086240_7954_0',
    'n02089973_3651_1',
    'n02110185_10844_0',
    'n02110185_10844_1',
    'n02104365_8998_1',
    'n02104365_9489_0',
    'n02085782_4798_0',
    'n02087394_2364_1',
    'n02111277_5789_0',
    'n02099849_3976_0',
    'n02111277_7377_1',
    'n02088094_5504_0',
    'n02098286_5357_0',
    'n02088094_3613_0',
    'n02088094_3613_1',
    'n02095889_1120_0',
    'n02087046_4987_0',
    'n02106166_1204_0',
    'n02091134_15938_0',
    'n02091134_15938_1',
    'n02099429_3103_0',
    'n02090622_7111_0',
    'n02105412_8166_0',
    'n02113712_2150_0',
    'n02116738_5068_0',
    'n02094114_315_0',
    'n02090622_7663_1',
    'n02105641_1815_0',
    'n02102318_8250_0',
    'n02095889_371_0',
    'n02116738_7657_0',
    'n02092002_847_0',
    'n02111129_294_0',
    'n02091032_5_0',
    'n02112018_5807_0',
    'n02105162_6513_0',
    'n02113978_593_1',
    'n02097047_2937_0',
    'n02105505_2178_0',
    'n02101388_10107_0',
    'n02111500_7304_0',
    'n02099712_4913_0',
    'n02105855_19486_0',
    'n02105251_8543_0',
    'n02108422_170_0',
    'n02108422_170_1',
    'n02111277_2540_0',
    'n02091635_4698_0',
    'n02107683_381_0',
    'n02098286_1124_0',
    'n02106382_2343_0',
    'n02111889_6333_1',
    'n02093754_7091_0',
    'n02089867_1240_0',
    'n02091635_2766_0',
    'n02101388_3697_0',
    'n02105855_2376_0',
    'n02095889_6458_1',
    'n02093859_321_0',
    'n02097209_3151_1',
    'n02085782_4772_0',
    'n02095889_25_0',
    'n02101556_2775_0',
    'n02110958_12781_0',
    'n02091635_1333_0',
    'n02094258_1510_0',
    'n02110185_632_2',
    'n02108000_1600_0',
    'n02113624_925_0',
    'n02099849_4413_0',
    'n02092339_6114_0',
    'n02106662_9556_0',
    'n02110185_815_1',
    'n02111500_2863_0',
    'n02111500_8382_0',
    'n02111500_8382_1',
    'n02091244_2838_0',
    'n02115913_1796_0',
    'n02100236_3934_0',
    'n02088364_11930_0',
    'n02105412_6770_0',
    'n02092002_5008_1',
    'n02105251_5649_0',
    'n02108422_2990_1',
    'n02093991_4306_1',
    'n02090622_6408_0',
    'n02111889_1716_0',
    'n02107574_854_0',
    'n02085936_8981_0',
    'n02090721_708_0',
    'n02090721_708_1',
    'n02088632_1236_0',
    'n02098105_597_0',
    'n02115641_6407_0',
    'n02090721_1002_0',
    'n02100877_511_0',
    'n02088632_4414_0',
    'n02110185_13794_0',
    'n02102177_656_0',
    'n02099712_5599_0',
    'n02092002_15198_0',
    'n02097130_4446_0',
    'n02091134_2665_0',
    'n02112706_1922_0',
    'n02099429_2393_0',
    'n02106550_11728_0',
    'n02086240_2961_0',
    'n02111277_7010_0',
    'n02088238_13709_0',
    'n02088466_7191_0',
    'n02111500_2668_0',
    'n02091467_5184_0',
    'n02116738_1627_1',
    'n02095889_3493_0',
    'n02116738_3024_0',
    'n02087394_5552_0',
    'n02116738_1948_0',
    'n02090721_452_0',
    'n02095889_5141_0',
    'n02089078_3615_0',
    'n02099849_2847_0',
    'n02101556_2003_0',
    'n02088238_12563_0',
    'n02107683_3797_0',
    'n02107683_3797_2',
    'n02101556_4499_0',
    'n02116738_9333_0',
    'n02116738_9333_1',
    'n02102318_11445_0',
    'n02115913_2338_0',
    'n02107574_298_0',
    'n02105162_9368_0',
    'n02092002_1646_0',
    'n02109961_3992_0',
    'n02085936_22439_0',
    'n02095889_5431_0',
    'n02111129_253_0',
    'n02111129_1737_0',
    'n02111129_5237_0',
    'n02096051_9359_0',
    'n02089078_4422_0',
    'n02092339_2766_0',
    'n02111500_2522_0',
    'n02110185_7329_0',
    'n02098413_244_0',
    'n02111277_399_0',
    'n02105162_7621_0',
    'n02090622_7100_0',
    'n02099849_2462_0',
    'n02106382_1316_0',
    'n02100735_3998_0',
    'n02108915_7115_0',
    'n02105505_4256_0',
    'n02088466_8664_0',
    'n02105505_1312_0',
    'n02090622_9662_0',
    'n02111500_1943_0',
    'n02087046_2316_0',
    'n02087046_4001_0',
    'n02095570_4846_0',
    'n02101556_2566_0',
    'n02105162_5547_0',
    'n02091635_2011_0',
    'n02111277_5955_0',
    'n02110958_15766_2',
    'n02088632_982_0',
    'n02093859_3140_0',
    'n02097209_2276_1',
    'n02100735_3595_0',
    'n02110627_8048_0',
    'n02109961_8187_0',
    'n02110958_15969_0',
    'n02093859_3168_0',
    'n02110185_9846_0',
    'n02091831_5745_0',
    'n02111129_1497_2',
    'n02110627_13782_0',
    'n02087394_9369_0',
    'n02094114_3925_1',
    'n02097130_2552_0',
    'n02094433_2417_0',
    'n02096437_603_0',
    'n02090622_3763_0',
    'n02088466_7609_0',
    'n02091635_3521_0',
    'n02105855_17096_1',
    'n02089973_1877_0',
    'n02086240_12348_0',
    'n02101556_2604_1',
    'n02110806_318_1',
    'n02093256_5428_0',
    'n02113799_1532_0',
    'n02097209_1353_2',
    'n02090721_1981_0',
    'n02111129_454_0',
    'n02096177_4768_0',
    'n02107908_5002_1',
    'n02101556_2362_0',
    'n02086240_1927_1',
    'n02097047_2663_1',
    'n02106166_361_0',
    'n02102318_3511_0',
    'n02088094_1823_0',
    'n02109961_5066_0',
    'n02091467_2159_0',
    'n02088632_610_0',
    'n02100877_738_0',
    'n02088632_1745_0',
    'n02111129_5156_0',
    'n02112350_7566_0',
    'n02112018_10309_0',
    'n02093859_3036_0',
    'n02102480_8030_0',
    'n02100236_3714_0',
    'n02110185_1439_0',
    'n02096585_994_0',
    'n02110063_17378_0',
    'n02109525_8211_0',
    'n02102480_8187_0',
    'n02111889_5826_0',
    'n02106382_653_0',
    'n02100735_2851_1',
    'n02085620_500_0',
    'n02086079_23100_0',
    'n02102973_2451_0',
    'n02091635_1240_0',
    'n02091134_4149_0',
    'n02101388_10470_1',
    'n02105505_3705_0',
    'n02107142_18214_0',
    'n02090622_3615_0',
    'n02100735_7054_0',
    'n02110806_4400_0',
    'n02096294_671_0',
    'n02113186_11037_0',
    'n02111277_11934_0',
    'n02091831_13774_0',
    'n02087394_3256_0',
    'n02112018_2821_0',
    'n02110185_9461_0',
    'n02107574_926_0',
    'n02088238_11281_0',
    'n02090721_1835_0',
    'n02115913_614_0',
    'n02099601_14_0',
    'n02095570_1068_0',
    'n02111129_279_1',
    'n02095889_4077_1',
    'n02095889_6106_0',
    'n02098286_2359_0',
    'n02093859_1218_0',
    'n02089973_4307_0',
    'n02086646_3536_0',
    'n02086646_3536_1',
    'n02108000_716_0',
    'n02107908_2340_0',
    'n02089973_1733_0',
    'n02112137_15770_0',
    'n02111500_2905_0',
    'n02097658_5420_1',
    'n02113023_186_0',
    'n02091134_14002_0',
    'n02093859_1813_0',
    'n02115913_3178_1',
    'n02115913_3178_2',
    'n02091467_3285_0',
    'n02107683_6772_0',
    'n02096585_956_0',
    'n02089867_55_0',
    'n02089867_55_1',
    'n02096585_942_0',
    'n02094433_3905_0',
    'n02116738_1180_1',
    'n02102318_12238_0',
    'n02091032_9115_0',
    'n02097130_4336_0',
    'n02111129_3917_0',
    'n02116738_10024_0',
    'n02104029_2246_0',
    'n02113023_2919_0',
    'n02099429_583_0',
    'n02088238_10028_1',
    'n02110806_3781_1',
    'n02115641_11220_0',
    'n02111500_9298_0',
    'n02093859_3209_0',
    'n02095889_5221_2',
    'n02107908_2723_1',
    'n02088466_3184_0',
    'n02096177_2343_0',
    'n02112018_12020_0',
    'n02107574_1441_0',
    'n02113978_451_0',
    'n02093859_3291_0',
    'n02088238_9922_0',
    'n02105251_3265_0',
    'n02115913_1244_0',
    'n02110185_11131_0',
    'n02111129_3541_0',
    'n02098286_3424_0',
    'n02106662_11808_0',
    'n02093428_8324_0',
    'n02102177_3916_0',
    'n02097474_6280_1',
    'n02091831_6406_0',
    'n02091831_6406_1',
    'n02108089_3162_0',
    'n02100236_3612_0',
    'n02090379_5196_0',
    'n02106382_2322_1',
    'n02093754_5195_0',
    'n02110185_10171_0',
    'n02095889_107_0',
    'n02107683_6846_0',
    'n02090379_5182_0',
    'n02105251_7349_0',
    'n02111500_5599_0',
    'n02113624_429_0',
    'n02111277_3165_0',
    'n02097658_9043_0',
    'n02093428_12016_0',
    'n02102318_11805_0',
    'n02111889_662_1',
    'n02097298_9499_0',
    'n02102177_2611_0',
    'n02111500_8042_0',
    'n02110806_3123_0',
    'n02110806_3123_1',
    'n02099601_3073_0',
    'n02109525_6663_0',
    'n02100877_5861_0',
    'n02097298_6740_1',
    'n02111277_1029_0',
    'n02097047_2002_0',
    'n02093754_6106_0',
    'n02110063_12449_0',
    'n02110063_15332_0',
    'n02105505_4031_0',
    'n02102040_1244_1',
    'n02110627_3144_0',
    'n02085936_9037_0',
    'n02099712_5648_0',
    'n02088632_1118_0',
    'n02098105_3662_0',
    'n02088364_17689_0',
    'n02102973_2224_0',
    'n02115913_1047_0',
    'n02116738_246_0',
    'n02116738_246_1',
    'n02108089_7259_0',
    'n02086240_6222_0',
    'n02105162_5330_0',
    'n02113186_7231_2',
    'n02091134_4099_0',
    'n02095314_1395_0',
    'n02099849_669_0',
    'n02107142_5144_0',
    'n02100236_521_0',
    'n02110806_3056_0',
    'n02102177_626_0',
    'n02108000_3249_0',
    'n02111277_289_0',
    'n02111889_1762_0',
    'n02106662_25986_0',
    'n02092002_1583_0',
    'n02113186_6477_0',
    'n02106030_538_0',
    'n02109047_31376_0',
    'n02111129_1_0',
    'n02105855_12412_0',
    'n02107683_3478_0',
    'n02098286_4176_0',
    'n02111129_2476_1',
    'n02111129_2476_2',
    'n02111129_2476_3',
    'n02110063_11585_1',
    'n02095570_3021_0',
    'n02098413_342_0',
    'n02107908_2085_0',
    'n02096177_4916_0',
    'n02095889_4826_0',
    'n02095889_931_1',
    'n02096585_10604_0',
    'n02105056_6523_0',
    'n02100236_44_0',
    'n02113186_13533_1',
    'n02098286_278_0',
    'n02107908_4806_0',
    'n02093256_1826_1',
    'n02092002_6007_0',
    'n02096437_2117_0',
    'n02086646_1621_0',
    'n02094114_3177_0',
    'n02112350_9300_1',
    'n02108000_2586_0',
    'n02110185_58_0',
    'n02113186_7353_0',
    'n02091244_2709_0',
    'n02104029_1313_0',
    'n02092002_1608_0',
    'n02097298_2083_0',
    'n02091134_917_0',
    'n02091134_917_1',
    'n02093428_592_1',
    'n02097047_1535_0',
    'n02090622_6293_0',
    'n02099849_253_0',
    'n02113186_7145_0',
    'n02098413_2582_1',
    'n02102177_3524_0',
    'n02086240_4999_0',
    'n02088238_9841_0',
    'n02113712_5675_0',
    'n02108422_2111_0',
    'n02105855_13876_0',
    'n02095889_4774_2',
    'n02110063_17917_0',
    'n02111500_7398_0',
    'n02099712_3776_0',
    'n02095889_1397_0',
    'n02094258_2668_0',
    'n02105162_10133_0',
    'n02086910_5707_0',
    'n02086646_3989_0',
    'n02105056_4533_0',
    'n02087394_8993_0',
    'n02086646_416_0',
    'n02101556_2689_0',
    'n02096294_7051_0',
    'n02101388_4762_0',
    'n02088632_1047_0',
    'n02099849_130_0',
    'n02100877_4639_2',
    'n02101556_4213_1',
    'n02110958_14768_0',
    'n02092002_10911_0',
    'n02086240_4608_0',
    'n02105505_4436_1',
    'n02115641_925_0',
    'n02115913_739_1',
    'n02111889_4194_0',
    'n02104365_9004_0',
    'n02091244_5488_0',
    'n02089973_1352_1',
    'n02089973_1352_3',
    'n02111277_1628_0',
    'n02111277_1628_1',
    'n02109525_1902_0',
    'n02093754_2207_0',
    'n02106662_13599_0',
    'n02102318_12265_0',
    'n02102318_12265_1',
    'n02110627_1387_0',
    'n02105412_1078_1',
    'n02085620_8611_0',
    'n02100735_8071_0',
    'n02116738_7590_1',
    'n02097209_1133_0',
    'n02092339_767_0',
    'n02107574_2370_0',
    'n02101556_7078_0',
    'n02107908_94_0',
    'n02107683_735_0',
    'n02087394_1743_0',
    'n02100735_7154_0',
    'n02104029_1510_0',
    'n02111129_2063_2',
    'n02111129_2063_3',
    'n02111129_754_0',
    'n02096437_926_0',
    'n02090721_3500_0',
    'n02095570_3391_0',
    'n02097298_7115_0',
    'n02091831_11498_1',
    'n02090721_1303_0',
    'n02113799_1183_0',
    'n02098413_3470_0',
    'n02090622_9358_1',
    'n02090379_3734_0',
    'n02105641_7219_0',
    'n02107683_494_0',
    'n02091467_3637_0',
    'n02097047_162_0',
    'n02113978_1595_0',
    'n02108089_3400_0',
    'n02095889_471_0',
    'n02086079_10958_0',
    'n02102480_5158_1',
    'n02091134_12017_0',
    'n02115913_1323_1',
    'n02101006_2902_0',
    'n02091134_4470_0',
    'n02102480_2622_0',
    'n02109961_21073_1',
    'n02099429_2291_0',
    'n02091134_7145_0',
    'n02091134_12759_0',
    'n02091134_12759_1',
    'n02108000_1538_0',
    'n02098413_6737_0',
    'n02099712_3773_0',
    'n02088364_4237_0',
    'n02095570_337_0',
    'n02113799_848_0',
    'n02099267_1906_0',
    'n02104365_7158_0',
    'n02099601_4256_0',
    'n02100877_1803_0',
    'n02115913_4059_0',
    'n02091831_7051_0',
    'n02091831_7051_1',
    'n02094433_2266_0',
    'n02094433_2266_1',
    'n02107683_4924_0',
    'n02105855_1816_0',
    'n02111500_3306_0',
    'n02110806_1525_0',
    'n02096294_1586_0',
    'n02112137_10654_0',
    'n02093991_2498_0',
    'n02097298_9677_0',
    'n02086079_207_0',
    'n02111129_2062_0',
    'n02106382_154_0',
    'n02106550_6130_0',
    'n02102177_1055_0',
    'n02089973_97_2',
    'n02094433_4005_0',
    'n02110958_11359_0',
    'n02091032_9405_1',
    'n02088094_6485_0',
    'n02091032_1071_0',
    'n02116738_3720_0',
    'n02109047_5936_0',
    'n02086240_11622_1',
    'n02086079_13897_0',
    'n02097298_91_0',
    'n02105505_4180_0',
    'n02097130_864_0',
    'n02090721_550_0',
    'n02113186_11334_0',
    'n02086646_1023_0',
    'n02116738_4098_0',
    'n02112018_2277_0',
    'n02104365_2424_0',
    'n02116738_2600_0',
    'n02091244_177_0',
    'n02095570_280_0',
    'n02085620_1152_2',
    'n02111129_1184_0',
    'n02105251_5175_0',
    'n02116738_9769_0',
    'n02116738_5635_0',
    'n02116738_5635_1',
    'n02086646_1590_0',
    'n02091831_8028_1',
    'n02100583_11752_0',
    'n02105505_4382_0',
    'n02089973_1357_1',
    'n02090721_4130_1',
    'n02095570_269_0',
    'n02105412_150_0',
    'n02088364_9895_1',
    'n02093256_5139_0',
    'n02090379_3131_0',
    'n02091134_7796_0',
    'n02091032_10079_1',
    'n02091032_10079_2',
    'n02098413_20034_0',
    'n02094114_2125_0',
    'n02105412_3693_0',
    'n02091831_3180_0',
    'n02091831_3180_1',
    'n02094258_977_1',
    'n02102177_4311_0',
    'n02086646_2931_0',
    'n02093991_4404_1',
    'n02088238_9933_0',
    'n02105855_11445_0',
    'n02104029_4494_0',
    'n02086079_1759_0',
    'n02097474_5175_0',
    'n02087394_101_1',
    'n02088632_2207_0',
    'n02111889_6545_0',
    'n02091134_2349_0',
    'n02106382_2535_0',
    'n02104365_1852_0',
    'n02106166_1842_0',
    'n02113712_8008_0',
    'n02110185_9833_1',
    'n02086079_17205_0',
    'n02113186_13333_0',
    'n02108422_3793_0',
    'n02110627_4607_0',
    'n02112018_1146_0',
    'n02105251_8094_0',
    'n02115641_10570_0',
    'n02088364_17935_0',
    'n02106166_2595_0',
    'n02088466_7046_0',
    'n02100583_9794_0',
    'n02097209_3874_0',
    'n02115641_13253_0',
    'n02090721_2351_0',
    'n02086910_7301_1',
    'n02093754_7552_0',
    'n02097047_2984_0',
    'n02110063_97_0',
    'n02112706_2456_0',
    'n02112350_7115_0',
    'n02108551_9391_0',
    'n02105505_2685_0',
    'n02105505_2685_2',
    'n02116738_849_0',
    'n02091134_12029_0',
    'n02115913_3278_0',
    'n02088466_7244_0',
    'n02101388_2076_0',
    'n02091831_4980_0',
    'n02110627_7680_0',
    'n02089078_4331_0',
    'n02100583_11143_0',
    'n02106662_10858_0',
    'n02110958_4030_0',
    'n02086910_4609_0',
    'n02102040_690_0',
    'n02097474_1070_0',
    'n02090379_5435_0',
    'n02091635_965_0',
    'n02085936_3292_0',
    'n02089867_1225_0',
    'n02090622_6055_0',
    'n02110185_10175_0',
    'n02097298_8224_0',
    'n02111277_7105_0',
    'n02113978_1030_0',
    'n02095889_2897_0',
    'n02086079_15375_0',
    'n02108000_1671_0',
    'n02109961_2555_0',
    'n02090721_2967_0',
    'n02095570_5641_0',
    'n02113799_254_0',
    'n02111129_187_0',
    'n02092002_6955_0',
    'n02087046_309_0',
    'n02088466_9877_0',
    'n02090721_209_1',
    'n02089867_3585_0',
    'n02106030_18950_2',
    'n02106030_18950_3',
    'n02106030_18950_5',
    'n02096051_5884_0',
    'n02105056_4469_0',
    'n02111889_16414_0',
    'n02106550_4254_0',
    'n02108915_12139_0',
    'n02106662_4201_0',
    'n02092002_1551_1',
    'n02116738_7753_1',
    'n02095570_6176_0',
    'n02112137_7706_1',
    'n02115641_8463_0',
    'n02088632_4313_0',
    'n02104029_951_1',
    'n02110627_641_0',
    'n02101006_772_0',
    'n02098105_1306_0',
    'n02086910_557_0',
    'n02106550_5184_0',
    'n02101006_22_0',
    'n02108422_2046_1',
    'n02091134_14246_2',
    'n02090379_4875_1',
    'n02106662_24110_0',
    'n02086910_9056_0',
    'n02105505_3805_0',
    'n02091467_2122_0',
    'n02086240_12480_0',
    'n02085782_1058_0',
    'n02093256_4997_0',
    'n02093859_567_0',
    'n02088632_3667_0',
    'n02112018_4813_0',
    'n02089078_1867_0',
    'n02099267_3272_0',
    'n02088632_864_0',
    'n02110185_5624_0',
    'n02086646_421_0',
    'n02095570_5880_0',
    'n02102177_3658_0',
    'n02100877_151_0',
    'n02115913_90_0',
    'n02096437_929_1',
    'n02099849_2803_0',
    'n02093647_2687_0',
    'n02113978_2508_1',
    'n02104365_4107_0',
    'n02109047_2851_0',
    'n02098105_3865_0',
    'n02087394_10939_0',
    'n02111889_2667_1',
    'n02105855_14653_0',
    'n02090379_4054_0',
    'n02097658_6351_1',
    'n02098286_104_0',
    'n02111277_3150_0',
    'n02098105_2004_0',
    'n02088238_4374_0',
    'n02111277_2272_0',
    'n02089867_743_0',
    'n02110806_3880_0',
    'n02110806_3880_2',
    'n02091134_15038_0',
    'n02090721_4089_0',
    'n02090721_4089_1',
    'n02101006_2918_0',
    'n02088632_291_0',
    'n02104365_5967_0',
    'n02111500_5546_0',
    'n02099601_2358_0',
    'n02096294_4142_0',
    'n02116738_10895_0',
    'n02107683_5823_0',
    'n02089867_2287_0',
    'n02096437_1171_0',
    'n02088364_2661_0',
    'n02107683_1317_0',
    'n02085782_2635_1',
    'n02091032_18_1',
    'n02110627_11263_1',
    'n02088466_7162_0',
    'n02092002_5202_0'
]

if __name__ == '__main__':
    main()